<div [class]="Constants.CSS_table_outer_Container + ' '+ 'mat-elevation-z8'"
     [dir]="TableDirection">
  <!-- Filter div -->

  <div [class]="Table_Color_mode===Constants.dark?Constants.CSS_DarkTableBg + ' ' + Constants.CSS_TablefilterDiv
       :Constants.CSS_LightTableBg + ' ' + Constants.CSS_TablefilterDiv"
       fxLayout="row"
       fxLayoutAlign="space-between center">
    <div fxLayout="row">
      <!-- ................................................. Search table -->
      <div fxLayout="row"
           [dir]="translate.isRightToLeft(translate.GetCurrentLang())?'rtl':'ltr'"
           fxLayoutAlign="center center"
           class="SearchTable">
        <input #searchInput
               [placeholder]="translate.GetTranslation(Constants.Search_table)"
               (input)="Filter(searchInput.value)"
               type="text"
               value="" />
        <mat-icon class="mat-18"
                  matSuffix>
          search
        </mat-icon>
      </div>
      <span *ngIf="searchInput.value!==''"
            fxLayoutAlign="center center">
        {{dataSource.filteredData.length===0?
        translate.GetTranslation(Constants.NoMatchedData)
        :dataSource.filteredData.length!==0?
        translate.GetTranslation(Constants.Found) + ' '+ dataSource.filteredData.length + '
        '+translate.GetTranslation(Constants.results)
        :''}}
      </span>
    </div>
    <!-- ....................................................Settings button -->
    <button mat-button
            [dir]="translate.isRightToLeft(this.translate.GetCurrentLang())?'rtl':'ltr'"
            disableRipple="true"
            (click)="TableSettingClick()"
            #tableSettingsButton
            [matMenuTriggerFor]="TableSettings">
      <mat-icon class="mat-18">settings</mat-icon>
      <mat-menu #TableSettings
                [overlapTrigger]="false">
        <span mat-menu-item
              (click)="  $event.stopPropagation()"
              [class]="Constants.CSS_TableSettingsMenu"
              *ngFor="let col of columns; let i = index">
          <mat-checkbox color="primary"
                        (change)="SettingChange(col, i)"
                        [checked]="col.field!==''">
            <mat-icon class="mat-18"
                      *ngIf="col.HeaderfaIcon">
              <fa-icon [icon]="col.HeaderfaIcon"></fa-icon>
            </mat-icon>
            <mat-icon class="mat-18"
                      *ngIf="col.HeaderGoogleIcon">{{col.HeaderGoogleIcon}}</mat-icon>
            <span *ngIf="!col.HeaderGoogleIcon&&!col.HeaderfaIcon">
              {{col.display|translate}}
            </span>
          </mat-checkbox>
        </span>
      </mat-menu>
    </button>
  </div>
  <div [class]="Constants.CSS_table_container">
    <mat-progress-bar mode="indeterminate"
                      *ngIf="ShowProgressBar"></mat-progress-bar>
    <div [class]="Constants.CSS_loading_shade"
         *ngIf="isLoadingResults"
         style="min-height: 200px;">
      <mat-spinner *ngIf="isLoadingResults"
                   diameter="50"></mat-spinner>
    </div>

    <ng-template [ngIf]="NoData&& !isLoadingResults">
      <div style="min-height: 100px;"
           [class]="Constants.CSS_loading_shade">
        No rows are shown
      </div>
    </ng-template>
    <table mat-table
           [hidden]="items.length!==0"
           multiTemplateDataRows
           [class]="Table_Color_mode===Constants.dark?Constants.CSS_DarkTableBg
:Constants.CSS_LightTableBg"
           [dataSource]="dataSource"
           cdkDropList
           matSort
           cdkDropListOrientation="horizontal"
           (cdkDropListDropped)="dropListDropped($event)">

      <ng-container *ngFor="let column of columns; let i = index"
                    [matColumnDef]="column.field">
        <th mat-header-cell
            fxFlexAlign="center"
            *matHeaderCellDef
            cdkDrag
            cdkDragLockAxis="x"
            mat-sort-header>

          <ng-template [ngIf]="column.HeaderfaIcon || column.HeaderGoogleIcon">
            <mat-icon class="mat-18"
                      *ngIf="column.HeaderfaIcon">
              <fa-icon [icon]="column.HeaderfaIcon"></fa-icon>
            </mat-icon>
            <mat-icon class="mat-18"
                      *ngIf="column.HeaderGoogleIcon">
              {{column.HeaderGoogleIcon}}
            </mat-icon>
          </ng-template>
          <ng-template [ngIf]="!column.HeaderfaIcon && !column.HeaderGoogleIcon">
            {{translate.GetTranslation(column.display)}}
          </ng-template>
        </th>

        <td mat-cell
            *matCellDef="let row">

          <span *ngIf="!column.IsTrueOrFlase">
            {{row[column.field]}}
          </span>
          <span *ngIf="column.IsTrueOrFlase">
            <span *ngIf="column.True_faIcon || column.False_faIcon">
              <mat-icon class="mat-18"
                        [class]="Constants.CSS_green"
                        *ngIf="row[column.field]===true ">
                <fa-icon [icon]="column.True_faIcon"></fa-icon>
              </mat-icon>
              <mat-icon class="mat-18"
                        [class]="Constants.CSS_red"
                        *ngIf="row[column.field]===false">
                <fa-icon [icon]="column.False_faIcon"></fa-icon>
              </mat-icon>
            </span>
            <span *ngIf="column.True_GoogleIcon || column.False_GoogleIcon">
              <mat-icon class="mat-18"
                        [class]="Constants.CSS_green"
                        *ngIf="row[column.field]===true ">
                {{column.True_GoogleIcon }}
              </mat-icon>
              <mat-icon class="mat-18"
                        [class]="Constants.CSS_red"
                        *ngIf="row[column.field]===false">
                {{column.False_GoogleIcon}}
              </mat-icon>
            </span>
          </span>

        </td>

      </ng-container>
      <ng-container matColumnDef="Delete">
        <th mat-header-cell
            *matHeaderCellDef> {{Constants.Delete | translate}} </th>
        <td mat-cell
            *matCellDef="let element">
          <button mat-icon-button
                  *ngIf="element.name!== PreventDeleteFor"
                  color="warn"
                  (click)="Delete(element)">
            <mat-icon class="mat-18">delete</mat-icon>
          </button>
        </td>
      </ng-container>
      <ng-container matColumnDef="Edit">
        <th mat-header-cell
            *matHeaderCellDef> {{Constants.Edit | translate}} </th>
        <td mat-cell
            *matCellDef="let element">
          <button mat-icon-button
                  color="primary"
                  (click)="Edit(element)">
            <fa-icon [icon]="faEdit"
                     style="font-size: 18px;"></fa-icon>
          </button>
        </td>
      </ng-container>
      <tr mat-header-row
          [ngClass]="ThemeColors.bg"
          [class]="ThemeColors.colorName==='organge'||ThemeColors.colorName==='amber'?Constants.CSS_dark_color:
         Constants.CSS_text_white"
          *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row
          (click)="SelectRow(row)"
          (dblclick)="Dbclick(row)"
          [class]="SelectedRows.includes(row) && Table_Color_mode===Constants.dark?  Constants.CSS_DarkRowSelection:
         SelectedRows.includes(row) && Table_Color_mode===Constants.light?Constants.CSS_LightRowSelection:'' "
          *matRowDef="let row; columns: displayedColumns;"></tr>

    </table>
    <mat-divider style="max-width: 100%;"></mat-divider>

  </div>
  <mat-paginator [length]="items.length"
                 fixed
                 style-paginator
                 [hidden]="!isLoadingResults"
                 [class]="Table_Color_mode===Constants.dark?Constants.CSS_DarkTableBg
:Constants.CSS_LightTableBg"
                 [pageSize]="2"
                 [pageSizeOptions]="[2, 4, 6, 10, 20]"
                 [class]="Table_Color_mode===Constants.dark?Constants.CSS_DarkTableBg
              :Constants.CSS_LightTableBg"
                 showFirstLastButtons
                 [showTotalPages]="3"
                 aria-label="Select page of warehouses search results"></mat-paginator>
</div>
